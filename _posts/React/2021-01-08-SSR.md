---
title: SSR(Server Side Rendering)
categories: [React]
comments: true
---

# SSR(Server Side Rendering)

[Bluemap 프로젝트](https://github.com/haena3230/bluemap)를 진행하면서, SPA 애플리케이션이 구동하기 위해 필요한 부분들에 대해 알게 되어 정리하게 되었다. **webpack**을 다루는 예제를 진행해 보았다.

### 초기 렌더링을 브라우저가 아닌 서버쪽에서 처리

- 사용자는 서버에서 렌더링한 html 결과물 그대로 사용
- 웹 서비스의 `**초기 로딩 속도**` 개선
- 캐싱 및 `**검색 엔진 최적화**`

### 단점

- 원래 브라우저가 해야 할 일을 서버가 대신 처리 → 서버 리소스 사용
- `**서버 과부하**` 발생 가능성 존재 → 캐싱과 로드 밸런싱을 통해 성능 최적화 필요
- 프로젝트 구조가 복잡해지고 고려해야 할 사항이 많아진다.
- 별도의 호환 없이 서버 사이드 렌더링과 코드 스플리팅을 함께 적용하면 페이지 깜빡임 발생

→ Loadable Components 라이브러리의 기능을 통해 서버사이드 렌더링 후 필요한 파일의 경로를 추출하여 렌더링 결과에 스크립트/ 스타일태그를 삽입하는 방법을 사용

### 사용시

- 코드에서 node_modules 내부의 라이브러리를 불러올 수 있게 설정하면 결과물 파일 안에 리액트 라이브러리가 들어 있지 않아도 바로 불러와서 사용 가능

→ 서버를 위해 번들링 할때는 node_modules에서 불러오는 것을 제외하고 번들링하는 것이 좋다

→ webpack-node-externals 라이브러리 사용 가능

- 환경변수를 주입하면 프로젝트 내에서 process.env.NODE_ENV값을 참조하여 현재 개발 환경인지 아닌지 알 수 있음

### StaticRouter

- 서버사이드 렌더링 용도로 사용되는 라우터.
- props로 넣어 주는 location 값에 따라 라우팅 해줌

### 데이터 로딩(API 요청)

- 서버의 경우 문자열 형태로 렌더링하는 것으로 state, 리덕스 스토어의 상태가 바뀐다고 해서 자동으로 리렌더링되지 않음 → renderToString함수를 한번 더 호출해 줘야함
- redux-thunk , redux-saga 미들웨어를 사용하여 API를 호출하는 환경에서 서버사이드 렌더링 가능

### SSR 연습 Girhub Repository

[haena3230/practiceSSR](https://github.com/haena3230/practiceSSR.git)

# Next.js

### 장점

1. `**Zero Configuration**`이라는 특징에 맞게 플랫폼 관리 시간이 적게 들고 컴포넌트 개발을 통한 서비스 개발에 집중할 수 있게 함
2. 데이터 프리패칭 지원 - SSG(Static Site Generation), SSR(ServerSide Rendering) 사용가능 (CSR도 사용가능)
3. 개발 모드를 위한 서버 뿐만 아니라, 프로덕션 서버(BFF)도 제공 및 다양한 서버 라이브러리(`**Express**`, `**Koa**`)로 수정 가능
4. SSR 지원 및 Google Chrome 팀과 협업으로 SEO 및 로드 성능이 높음
5. 코드베이스가 TypeScript이고, 자체적으로 TypeScript 지원
6. 특별한 설정을 하지 않아도 지원해주는 개발 편의기능 (페이지에 사용되는 코드만 로드하는 `**code-splitting**`를 통한 번들 최적화, 파일 기반 라우팅, Webpack, Babel을 이용한 자동 컴필레이션 및 번들링, `**React Fast Refresh**`, `**SSG**`, `**SSR**`, static 파일 서빙시 `**./public**`를 `**/**`에 매핑해줌)

### 단점

1. 커스텀해야 할 부분이 생길 경우가 있음 (그러나 CRA eject에 비하면 편리)
   - `**next.config.js**` - next-transpile-modules, spritePlugin, optimizedImages
   - `**custom server**` - 지원하지 않는 브라우저 처리, abtest, urlRewrite, naverAuth 등 미들웨어
2. 리액트 프레임워크이기 때문에 프레임워크에 대한 지식 필요(**\_app.js**, **\_document.js** 등)
